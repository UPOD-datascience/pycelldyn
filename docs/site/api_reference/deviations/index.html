
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://kite-msat-ds.github.io/kipy/api_reference/deviations/">
      
      
        <link rel="prev" href="../feat_engineering/">
      
      
        <link rel="next" href="../kpis/">
      
      
      <link rel="icon" href="../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>Deviations - KiPy</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="kite" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kipy.get_action_limits" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="KiPy" class="md-header__button md-logo" aria-label="KiPy" data-md-component="logo">
      
  <img src="../../images/icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KiPy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Deviations
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="kite" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/kite-msat-ds/kipy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="KiPy" class="md-nav__button md-logo" aria-label="KiPy" data-md-component="logo">
      
  <img src="../../images/icon.png" alt="logo">

    </a>
    KiPy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kite-msat-ds/kipy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
      
        
          
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Home
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../input_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre-processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../feat_engineering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature Engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Deviations
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Deviations
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kipy.get_action_limits" class="md-nav__link">
    kipy.get_action_limits
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_action_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_action_limits--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_control_limits" class="md-nav__link">
    kipy.get_control_limits
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_control_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_control_limits--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_median" class="md-nav__link">
    kipy.get_median
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_oos_cols" class="md-nav__link">
    kipy.get_oos_cols
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_oos_cols">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_oos_cols--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_excursion_cols" class="md-nav__link">
    kipy.get_excursion_cols
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_excursion_cols">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_excursion_cols--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_deviation_cols_extra" class="md-nav__link">
    kipy.get_deviation_cols_extra
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_deviation_cols_extra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_deviation_cols_extra--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.classify_deviation" class="md-nav__link">
    kipy.classify_deviation
  </a>
  
    <nav class="md-nav" aria-label="kipy.classify_deviation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.classify_deviation--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.classify_deviation_extra" class="md-nav__link">
    kipy.classify_deviation_extra
  </a>
  
    <nav class="md-nav" aria-label="kipy.classify_deviation_extra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.classify_deviation_extra--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_batches_oos_list" class="md-nav__link">
    kipy.get_batches_oos_list
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_batches_oos_list">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_batches_oos_list--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.count_deviations" class="md-nav__link">
    kipy.count_deviations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_deviation_summary" class="md-nav__link">
    kipy.get_deviation_summary
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_deviation_summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_deviation_summary--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../kpis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KPIs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../visualizations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualizations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../miscellaneous/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miscellaneous
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../examples/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kipy.get_action_limits" class="md-nav__link">
    kipy.get_action_limits
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_action_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_action_limits--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_control_limits" class="md-nav__link">
    kipy.get_control_limits
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_control_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_control_limits--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_median" class="md-nav__link">
    kipy.get_median
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_oos_cols" class="md-nav__link">
    kipy.get_oos_cols
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_oos_cols">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_oos_cols--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_excursion_cols" class="md-nav__link">
    kipy.get_excursion_cols
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_excursion_cols">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_excursion_cols--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_deviation_cols_extra" class="md-nav__link">
    kipy.get_deviation_cols_extra
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_deviation_cols_extra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_deviation_cols_extra--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.classify_deviation" class="md-nav__link">
    kipy.classify_deviation
  </a>
  
    <nav class="md-nav" aria-label="kipy.classify_deviation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.classify_deviation--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.classify_deviation_extra" class="md-nav__link">
    kipy.classify_deviation_extra
  </a>
  
    <nav class="md-nav" aria-label="kipy.classify_deviation_extra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.classify_deviation_extra--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_batches_oos_list" class="md-nav__link">
    kipy.get_batches_oos_list
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_batches_oos_list">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_batches_oos_list--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.count_deviations" class="md-nav__link">
    kipy.count_deviations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kipy.get_deviation_summary" class="md-nav__link">
    kipy.get_deviation_summary
  </a>
  
    <nav class="md-nav" aria-label="kipy.get_deviation_summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kipy.get_deviation_summary--see-also" class="md-nav__link">
    See also
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Deviations</h1>

<p>These functions are used for identifying and classifying deviations. 
These are very useful for process monitoring.</p>


<div class="doc doc-object doc-function">


<a id="kipy.get_action_limits"></a>
  <div class="doc doc-contents first">
  
      <p><code>get_action_limits</code></p>
<p>Get the action limits of a given product.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>If any of the action limits are changed, this function needs 
to be updated.</p>
</div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>product</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The product of interest. Possible values are:</p>
<ul>
<li><code>yescarta</code> or <code>clp</code></li>
<li><code>tecartus</code> or <code>xlp</code></li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>param_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Parameter name. For possible values, see the documents</p>
<ul>
<li>YESCARTA Column Mapping.docx</li>
<li>TECARTUS Column Mapping.docx</li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>lal, ual</code>
          </td>
          <td><p>A tuple with the lower action limit and upper action limit
of the given parameter.</p></td>
        </tr>
    </tbody>
  </table>
      <h3 id="kipy.get_action_limits--references">References</h3>
<ul>
<li>
<p>YESCARTA in-process controls (IPCs) are defined in the report
"REP-23526 Control Limits Justification for YESCARTA at TCF04"
(p. 4, Table 1)</p>
</li>
<li>
<p>YESCARTA critical quality attributes (CQAs) are defined in the report
"REP-23526 Control Limits Justification for YESCARTA at TCF04"
(p. 8, Table 3)</p>
</li>
<li>
<p>TECARTUS in-process controls (IPCs) are defined in the report
"REP-43562 Control Limits Justification for the Production of TECARTUS at TCF04"
(p. 5, Table 1).</p>
</li>
<li>
<p>TECARTUS critical quality attributes (CQAs) are defined in the report
"REP-43562 Control Limits Justification for the Production of TECARTUS at TCF04"
(p. 7, Table 3).</p>
</li>
</ul>

      <details class="quote">
        <summary>Source code in <code>kipy\deviations.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_action_limits</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">param_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`get_action_limits`</span>

<span class="sd">    Get the action limits of a given product.</span>

<span class="sd">    !!! danger</span>

<span class="sd">        If any of the action limits are changed, this function needs </span>
<span class="sd">        to be updated.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    product : str</span>
<span class="sd">        The product of interest. Possible values are:</span>

<span class="sd">        * `yescarta` or `clp`</span>
<span class="sd">        * `tecartus` or `xlp`</span>

<span class="sd">    param_name : str</span>
<span class="sd">        Parameter name. For possible values, see the documents</span>

<span class="sd">        * YESCARTA Column Mapping.docx</span>
<span class="sd">        * TECARTUS Column Mapping.docx</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    lal, ual : tuple</span>
<span class="sd">        A tuple with the lower action limit and upper action limit</span>
<span class="sd">        of the given parameter.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    * YESCARTA in-process controls (IPCs) are defined in the report</span>
<span class="sd">    &quot;REP-23526 Control Limits Justification for YESCARTA at TCF04&quot;</span>
<span class="sd">    (p. 4, Table 1)</span>

<span class="sd">    * YESCARTA critical quality attributes (CQAs) are defined in the report</span>
<span class="sd">    &quot;REP-23526 Control Limits Justification for YESCARTA at TCF04&quot;</span>
<span class="sd">    (p. 8, Table 3)</span>

<span class="sd">    * TECARTUS in-process controls (IPCs) are defined in the report</span>
<span class="sd">    &quot;REP-43562 Control Limits Justification for the Production of TECARTUS at TCF04&quot;</span>
<span class="sd">    (p. 5, Table 1).</span>

<span class="sd">    * TECARTUS critical quality attributes (CQAs) are defined in the report</span>
<span class="sd">    &quot;REP-43562 Control Limits Justification for the Production of TECARTUS at TCF04&quot;</span>
<span class="sd">    (p. 7, Table 3).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;yescarta&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;clp&#39;</span><span class="p">):</span>
        <span class="c1"># Exceptions</span>
        <span class="k">if</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;neatcell_viability&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">86</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;neatcell_recovery&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">16</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;pbmc_thaw_wash_viability&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">77</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="c1"># Notice that these values for PBMC are the same as frozen, </span>
        <span class="c1"># since they are considered kinda the same.</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_activation_density_pbmc&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mf">0.65e6</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="mf">2.50e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_activation_density_frozen&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mf">0.65e6</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="mf">2.50e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_activation_density_fresh&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mf">0.65e6</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="mf">2.50e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_wash1&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">59</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;transduction_postseeding_density&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mf">0.32e6</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="mf">0.80e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_wash2&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">68</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_min_expansion_viability&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">77</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="c1"># These values were updated after after AGILE-CC-01156</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;fold_expansion_per_day&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="mf">3.2</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;recovery_wash3&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">46</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># OOS</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_harvest&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">80</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;transduction_harvest&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">15</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;ifng&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">520</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;cd3_cells_p&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">85</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="c1"># VCN by ddPCR</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag1&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag2&#39;</span><span class="p">):</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Action limits for YESCARTA parameter </span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s2"> not defined&quot;</span><span class="p">)</span>


    <span class="k">elif</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;tecartus&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;xlp&#39;</span><span class="p">):</span>
        <span class="c1"># Exceptions</span>
        <span class="k">if</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;apheresis_viability&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">95</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_postwash2&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">89</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;postclinimacs_viability&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">86</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_postwash3&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">83</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;excess_tcell_viability_postwash&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">88</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcd_seeding_postactivation&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mf">0.4e6</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="mf">5.5e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_postwash4&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">56</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcd_seeding_posttransduction&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mf">0.3e6</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="mf">2.1e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_min_expansion_viability&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">53</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;fold_expansion_per_day&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mf">0.2</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;harvest_wash_recovery&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">61</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcd_average_final_formulation&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mf">1e6</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># OOS</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_harvest&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">72</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;transduction_harvest&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">24</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;ifng&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">190</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag1&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag2&#39;</span><span class="p">):</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;cd3_cells_p&#39;</span><span class="p">:</span>
            <span class="n">lal</span> <span class="o">=</span> <span class="mi">90</span>
            <span class="n">ual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Action limits for TECARTUS parameter </span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s2"> not defined&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s2"> is not a defined product&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lal</span><span class="p">,</span> <span class="n">ual</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">


<a id="kipy.get_control_limits"></a>
  <div class="doc doc-contents first">
  
      <p><code>get_control_limits</code></p>
<p>Get the control limits for a given product.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>If any of the control limits are changed, this function needs 
to be updated.</p>
</div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>product</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The product of interest. Possible values are:</p>
<ul>
<li><code>yescarta</code> or <code>clp</code></li>
<li><code>tecartus</code> or <code>xlp</code></li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>param_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Parameter name. For possible values, see the documents</p>
<ul>
<li>YESCARTA Column Mapping.docx</li>
<li>TECARTUS Column Mapping.docx</li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>lcl, ucl</code>
          </td>
          <td><p>A tuple with the lower control limit and upper control limit
of the given parameter.</p></td>
        </tr>
    </tbody>
  </table>
      <h3 id="kipy.get_control_limits--references">References</h3>
<ul>
<li>
<p>YESCARTA in-process controls (IPCs) are defined in the report
REP-23526 Control Limits Justification for YESCARTA at TCF04
(p. 4, Table 1)</p>
</li>
<li>
<p>YESCARTA critical quality attributes (CQAs) are defined in the report
REP-23526 Control Limits Justification for YESCARTA at TCF04
(p. 8, Table 3)</p>
</li>
<li>
<p>TECARTUS in-process controls (IPCs) are defined in the report
REP-43562 Control Limits Justification for the Production of TECARTUS at TCF04
(p. 5, Table 1).</p>
</li>
<li>
<p>TECARTUS critical quality attributes (CQAs) are defined in the report
REP-43562 Control Limits Justification for the Production of TECARTUS at TCF04
(p. 7, Table 3).</p>
</li>
</ul>

      <details class="quote">
        <summary>Source code in <code>kipy\deviations.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_control_limits</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">param_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`get_control_limits`</span>

<span class="sd">    Get the control limits for a given product.</span>

<span class="sd">    !!! danger</span>

<span class="sd">        If any of the control limits are changed, this function needs </span>
<span class="sd">        to be updated.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    product : str</span>
<span class="sd">        The product of interest. Possible values are:</span>

<span class="sd">        * `yescarta` or `clp`</span>
<span class="sd">        * `tecartus` or `xlp`</span>

<span class="sd">    param_name : str</span>
<span class="sd">        Parameter name. For possible values, see the documents</span>

<span class="sd">        * YESCARTA Column Mapping.docx</span>
<span class="sd">        * TECARTUS Column Mapping.docx</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    lcl, ucl : tuple</span>
<span class="sd">        A tuple with the lower control limit and upper control limit</span>
<span class="sd">        of the given parameter.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    * YESCARTA in-process controls (IPCs) are defined in the report</span>
<span class="sd">    REP-23526 Control Limits Justification for YESCARTA at TCF04</span>
<span class="sd">    (p. 4, Table 1)</span>

<span class="sd">    * YESCARTA critical quality attributes (CQAs) are defined in the report</span>
<span class="sd">    REP-23526 Control Limits Justification for YESCARTA at TCF04</span>
<span class="sd">    (p. 8, Table 3)</span>

<span class="sd">    * TECARTUS in-process controls (IPCs) are defined in the report</span>
<span class="sd">    REP-43562 Control Limits Justification for the Production of TECARTUS at TCF04</span>
<span class="sd">    (p. 5, Table 1).</span>

<span class="sd">    * TECARTUS critical quality attributes (CQAs) are defined in the report</span>
<span class="sd">    REP-43562 Control Limits Justification for the Production of TECARTUS at TCF04</span>
<span class="sd">    (p. 7, Table 3).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;yescarta&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;clp&#39;</span><span class="p">):</span>
        <span class="c1"># Exceptions</span>
        <span class="k">if</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;neatcell_viability&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">97</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;neatcell_recovery&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">43</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">85</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;pbmc_thaw_wash_viability&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">80</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">98</span>
        <span class="c1"># Notice that these values for PBMC are the same as frozen, </span>
        <span class="c1"># since they are considered kinda the same.</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_activation_density_pbmc&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">0.70e6</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">1.46e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_activation_density_frozen&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">0.70e6</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">1.46e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_activation_density_fresh&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">1.20e6</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">1.60e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_wash1&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">80</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">96</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;transduction_postseeding_density&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">0.42e6</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">0.64e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_wash2&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">89</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">97</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_min_expansion_viability&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">85</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">97</span>
        <span class="c1"># These values were updated after after AGILE-CC-01156</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;fold_expansion_per_day&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">0.6</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">2.4</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;recovery_wash3&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">69</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">115</span>

        <span class="c1"># OOS</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_harvest&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">84</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">97</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;transduction_harvest&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">38</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">84</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;ifng&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">760</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">13976</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;cd3_cells_p&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">91</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="c1"># VCN by ddPCR</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag1&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag2&#39;</span><span class="p">):</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">2.28</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">7.89</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control limits for YESCARTA parameter </span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s2"> not defined&quot;</span><span class="p">)</span>


    <span class="k">elif</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;tecartus&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;xlp&#39;</span><span class="p">):</span>
        <span class="c1"># Exceptions</span>
        <span class="k">if</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;apheresis_viability&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">97.6</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">99.9</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_postwash2&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">95.4</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">99.5</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;postclinimacs_viability&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">91.9</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">99.2</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_postwash3&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">89.7</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">99.2</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;excess_tcell_viability_postwash&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcd_seeding_postactivation&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">1.3e6</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">1.75e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_postwash4&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">79.9</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">97</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcd_seeding_posttransduction&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">0.73e6</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">1.12e6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_min_expansion_viability&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">73.2</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">95.3</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;fold_expansion_per_day&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">0.9</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">2.5</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;harvest_wash_recovery&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">76</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">120</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcd_average_final_formulation&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">1.1e6</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">4.7e6</span>

        <span class="c1"># OOS</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_harvest&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">75</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">95</span>    
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;transduction_harvest&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">53</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">86</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;ifng&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">2133</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">16504</span>  
        <span class="k">elif</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag1&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag2&#39;</span><span class="p">):</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mf">3.43</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mf">8.79</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;cd3_cells_p&#39;</span><span class="p">:</span>
            <span class="n">lcl</span> <span class="o">=</span> <span class="mi">97</span>
            <span class="n">ucl</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control limits for TECARTUS parameter </span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s2"> not defined&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s2"> is not a defined product&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lcl</span><span class="p">,</span> <span class="n">ucl</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">


<a id="kipy.get_median"></a>
  <div class="doc doc-contents first">
  
      <p><code>get_median</code></p>
<p>Get the median of the control charts for a given product.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>If any of the median values are changed, this function needs 
to be updated.</p>
</div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>product</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The product of interest. Possible values are:</p>
<ul>
<li><code>yescarta</code> or <code>clp</code></li>
<li><code>tecartus</code> or <code>xlp</code></li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>param_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Parameter name. For possible values, see the documents
* YESCARTA Column Mapping.docx
* TECARTUS Column Mapping.docx</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>median</code></td>          <td>
                <code>float</code>
          </td>
          <td><p>Float with the median of the given parameter.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
</div>
<p>Values were extracted from the process monitoring control charts
generated by PREDICTUM.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>kipy\deviations.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_median</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">param_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`get_median`</span>

<span class="sd">    Get the median of the control charts for a given product.</span>

<span class="sd">    !!! danger</span>

<span class="sd">        If any of the median values are changed, this function needs </span>
<span class="sd">        to be updated.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    product : str</span>
<span class="sd">        The product of interest. Possible values are:</span>

<span class="sd">        * `yescarta` or `clp`</span>
<span class="sd">        * `tecartus` or `xlp`</span>

<span class="sd">    param_name : str</span>
<span class="sd">        Parameter name. For possible values, see the documents</span>
<span class="sd">        * YESCARTA Column Mapping.docx</span>
<span class="sd">        * TECARTUS Column Mapping.docx</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    median : float</span>
<span class="sd">        Float with the median of the given parameter.</span>

<span class="sd">        !!! info</span>
<span class="sd">            Values were extracted from the process monitoring control charts</span>
<span class="sd">            generated by PREDICTUM.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;yescarta&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;clp&#39;</span><span class="p">):</span>
        <span class="c1"># Exceptions</span>
        <span class="k">if</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;neatcell_viability&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;neatcell_recovery&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;pbmc_thaw_wash_viability&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="c1"># Notice that these values for PBMC are the same as frozen, </span>
        <span class="c1"># since they are considered kinda the same.</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_activation_density_pbmc&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_activation_density_frozen&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_activation_density_fresh&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_wash1&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;transduction_postseeding_density&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_wash2&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_min_expansion_viability&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="c1"># These values were updated after after AGILE-CC-01156</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;fold_expansion_per_day&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;recovery_wash3&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># OOS</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_harvest&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;transduction_harvest&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;ifng&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;cd3_cells_p&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="c1"># VCN by ddPCR</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag1&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag2&#39;</span><span class="p">):</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median for YESCARTA parameter </span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s2"> not defined&quot;</span><span class="p">)</span>


    <span class="k">elif</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;tecartus&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;xlp&#39;</span><span class="p">):</span>
        <span class="c1"># Exceptions</span>
        <span class="k">if</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;apheresis_viability&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_postwash2&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;postclinimacs_viability&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_postwash3&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;excess_tcell_viability_postwash&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcd_seeding_postactivation&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_postwash4&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcd_seeding_posttransduction&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_min_expansion_viability&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;fold_expansion_per_day&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;harvest_wash_recovery&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcd_average_final_formulation&#39;</span><span class="p">:</span>
            <span class="c1">#TODO</span>
            <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># OOS</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;viability_harvest&#39;</span><span class="p">:</span>
            <span class="n">median</span> <span class="o">=</span> <span class="mi">88</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;transduction_harvest&#39;</span><span class="p">:</span>
            <span class="n">median</span> <span class="o">=</span> <span class="mi">72</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;ifng&#39;</span><span class="p">:</span>
            <span class="n">median</span> <span class="o">=</span> <span class="mi">8356</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag1&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag2&#39;</span><span class="p">):</span>
            <span class="n">median</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="k">elif</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;cd3_cells_p&#39;</span><span class="p">:</span>
            <span class="n">median</span> <span class="o">=</span> <span class="mi">99</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median for TECARTUS parameter </span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s2"> not defined&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s2"> is not a defined product&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">median</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">


<a id="kipy.get_oos_cols"></a>
  <div class="doc doc-contents first">
  
      <p><code>get_oos_cols</code></p>
<p>Get the name of columns that will be evaluated for OOS.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>product</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The product of interest. Possible values are:</p>
<ul>
<li><code>yescarta</code> or <code>clp</code></li>
<li><code>tecartus</code> or <code>xlp</code></li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>cols_oos</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>List of the column names that will be evaluated for OOS.</p></td>
        </tr>
    </tbody>
  </table>
      <h3 id="kipy.get_oos_cols--see-also">See also</h3>
<ul>
<li><a class="autorefs autorefs-internal" href="#kipy.classify_deviation"><code>kipy.classify_deviation</code></a></li>
</ul>

      <details class="quote">
        <summary>Source code in <code>kipy\deviations.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_oos_cols</span><span class="p">(</span><span class="n">product</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`get_oos_cols`</span>

<span class="sd">    Get the name of columns that will be evaluated for OOS.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    product : str</span>
<span class="sd">        The product of interest. Possible values are:</span>

<span class="sd">        * `yescarta` or `clp`</span>
<span class="sd">        * `tecartus` or `xlp`</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cols_oos : list</span>
<span class="sd">        List of the column names that will be evaluated for OOS.</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    * [`kipy.classify_deviation`][]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;yescarta&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;clp&#39;</span><span class="p">):</span>
        <span class="n">cols_oos</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ifng&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;cd3_cells_p&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;transduction_harvest&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;viability_harvest&#39;</span><span class="p">]</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;tecartus&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;xlp&#39;</span><span class="p">):</span> 
        <span class="n">cols_oos</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cd3_cells_p&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;ifng&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;transduction_harvest&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;vcn_bag1&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;vcn_bag2&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;viability_harvest&#39;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s2"> is not a valid product.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cols_oos</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">


<a id="kipy.get_excursion_cols"></a>
  <div class="doc doc-contents first">
  
      <p><code>get_excursion_cols</code></p>
<p>Get the name of columns that will be evaluated for excursions.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>product</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The product of interest. Possible values are:</p>
<ul>
<li><code>yescarta</code> or <code>clp</code></li>
<li><code>tecartus</code> or <code>xlp</code></li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>cols_excursion</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>List of the column names that will be evaluated for excursions.</p></td>
        </tr>
    </tbody>
  </table>
      <h3 id="kipy.get_excursion_cols--see-also">See also</h3>
<ul>
<li><a class="autorefs autorefs-internal" href="#kipy.classify_deviation"><code>kipy.classify_deviation</code></a></li>
</ul>

      <details class="quote">
        <summary>Source code in <code>kipy\deviations.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_excursion_cols</span><span class="p">(</span><span class="n">product</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`get_excursion_cols`</span>

<span class="sd">    Get the name of columns that will be evaluated for excursions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    product : str</span>
<span class="sd">        The product of interest. Possible values are:</span>

<span class="sd">        * `yescarta` or `clp`</span>
<span class="sd">        * `tecartus` or `xlp`</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cols_excursion : list</span>
<span class="sd">        List of the column names that will be evaluated for excursions.</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    * [`kipy.classify_deviation`][]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;yescarta&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;clp&#39;</span><span class="p">):</span>
        <span class="n">cols_excursion</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;neatcell_viability&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;neatcell_recovery&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;pbmc_thaw_wash_viability&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;tcell_activation_density&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;viability_wash1&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;transduction_postseeding_density&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;viability_wash2&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;tcell_min_expansion_viability&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;fold_expansion_per_day&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;recovery_wash3&#39;</span>
                          <span class="p">]</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;tecartus&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;xlp&#39;</span><span class="p">):</span>
        <span class="n">cols_excursion</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;apheresis_viability&#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;excess_tcell_viability_postwash&#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;excess_tcell_viability_postthaw&#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;viability_postwash2&#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;viability_postwash3&#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;viability_postwash4&#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;vcd_seeding_postactivation&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;vcd_seeding_posttransduction&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;tcell_min_expansion_viability&#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;fold_expansion_per_day&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;harvest_wash_recovery&#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;postclinimacs_viability&#39;</span><span class="p">,</span> 
                          <span class="s1">&#39;vcd_average_final_formulation&#39;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s2"> is not a valid product.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cols_excursion</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">


<a id="kipy.get_deviation_cols_extra"></a>
  <div class="doc doc-contents first">
  
      <p><code>get_deviation_cols_extras</code></p>
<p>Get the name of additional columns that will be evaluated for deviations,
but aren't strictly either OOS or excursions.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>product</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The product of interest. Possible values are:</p>
<ul>
<li><code>yescarta</code> or <code>clp</code></li>
<li><code>tecartus</code> or <code>xlp</code></li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>cols_extra</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>List of the column names that will be evaluated for deviations
that are neither OOS or excursions.</p></td>
        </tr>
    </tbody>
  </table>
      <h3 id="kipy.get_deviation_cols_extra--see-also">See also</h3>
<ul>
<li><a class="autorefs autorefs-internal" href="#kipy.classify_deviation_extra"><code>kipy.classify_deviation_extra</code></a></li>
</ul>

      <details class="quote">
        <summary>Source code in <code>kipy\deviations.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_deviation_cols_extra</span><span class="p">(</span><span class="n">product</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; `get_deviation_cols_extras`</span>

<span class="sd">    Get the name of additional columns that will be evaluated for deviations,</span>
<span class="sd">    but aren&#39;t strictly either OOS or excursions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    product : str</span>
<span class="sd">        The product of interest. Possible values are:</span>

<span class="sd">        * `yescarta` or `clp`</span>
<span class="sd">        * `tecartus` or `xlp`</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cols_extra : list</span>
<span class="sd">        List of the column names that will be evaluated for deviations</span>
<span class="sd">        that are neither OOS or excursions.</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    * [`kipy.classify_deviation_extra`][]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;yescarta&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;clp&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;tecartus&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;xlp&#39;</span><span class="p">):</span> 
        <span class="n">cols_extra</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vi_bag1&#39;</span><span class="p">,</span> <span class="s1">&#39;vi_bag2&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s2"> is not a valid product.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cols_extra</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">


<a id="kipy.classify_deviation"></a>
  <div class="doc doc-contents first">
  
      <p><code>classify_deviation</code> </p>
<p>Calculate if a parameter has a deviation (i.e., either excursion or
OOS) or not.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Remember deviations are defined based on action limits 
(and <em>not</em> on control limits).</p>
</div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>product</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The product of interest. Possible values are:</p>
<ul>
<li><code>yescarta</code> or <code>clp</code></li>
<li><code>tecartus</code> or <code>xlp</code></li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df</code></td>
          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Original DataFrame.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>param</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Parameter name. Possible values are the columns defined in 
<a class="autorefs autorefs-internal" href="#kipy.get_oos_cols"><code>kipy.get_oos_cols</code></a> and <a class="autorefs autorefs-internal" href="#kipy.get_excursion_cols"><code>kipy.get_excursion_cols</code></a></p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Define if verbose output will be printed (<code>True</code>) or not (<code>False</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>df_deviation</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>A copy of the input DataFrame with an extra boolean column named
<code>param + _deviation</code> that defines if a row was a deviation (True) 
or not (False).</p></td>
        </tr>
    </tbody>
  </table>
      <h3 id="kipy.classify_deviation--see-also">See also</h3>
<ul>
<li><a class="autorefs autorefs-internal" href="#kipy.get_oos_cols"><code>kipy.get_oos_cols</code></a></li>
<li><a class="autorefs autorefs-internal" href="#kipy.get_excursion_cols"><code>kipy.get_excursion_cols</code></a></li>
</ul>

      <details class="quote">
        <summary>Source code in <code>kipy\deviations.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">classify_deviation</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`classify_deviation` </span>

<span class="sd">    Calculate if a parameter has a deviation (i.e., either excursion or</span>
<span class="sd">    OOS) or not.</span>

<span class="sd">    !!! tip </span>
<span class="sd">        Remember deviations are defined based on action limits </span>
<span class="sd">        (and *not* on control limits).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    product : str</span>
<span class="sd">        The product of interest. Possible values are:</span>

<span class="sd">        * `yescarta` or `clp`</span>
<span class="sd">        * `tecartus` or `xlp`</span>

<span class="sd">    df : pandas DataFrame</span>
<span class="sd">        Original DataFrame.</span>

<span class="sd">    param : string</span>
<span class="sd">        Parameter name. Possible values are the columns defined in </span>
<span class="sd">        [`kipy.get_oos_cols`][] and [`kipy.get_excursion_cols`][]</span>

<span class="sd">    verbose : bool</span>
<span class="sd">        Define if verbose output will be printed (`True`) or not (`False`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_deviation : pandas DataFrame</span>
<span class="sd">        A copy of the input DataFrame with an extra boolean column named</span>
<span class="sd">        `param + _deviation` that defines if a row was a deviation (True) </span>
<span class="sd">        or not (False).</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    * [`kipy.get_oos_cols`][]</span>
<span class="sd">    * [`kipy.get_excursion_cols`][]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Classifying deviation for column </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Get the excursion and the OOS columns.</span>
    <span class="n">cols_excursion</span> <span class="o">=</span> <span class="n">get_excursion_cols</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
    <span class="n">cols_oos</span> <span class="o">=</span> <span class="n">get_oos_cols</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">cols_excursion</span><span class="p">:</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;_excursion&#39;</span>
    <span class="k">elif</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">cols_oos</span><span class="p">:</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;_oos&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="n">col_name_deviation</span> <span class="o">=</span> <span class="n">param</span> <span class="o">+</span> <span class="n">suffix</span>

    <span class="c1"># Create a new copy of the DataFrame.</span>
    <span class="n">df_deviation</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_classify_deviation</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">param_name</span><span class="p">):</span>

        <span class="n">param_value</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span>

        <span class="c1"># Since the limits of tcell_activation_density depend on the</span>
        <span class="c1"># apheresis_type, we need to incorporate the corresponding suffix.</span>
        <span class="k">if</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;tcell_activation_density&#39;</span><span class="p">:</span>
            <span class="n">param_name</span> <span class="o">=</span> <span class="n">param_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;apheresis_type&#39;</span><span class="p">]</span>

        <span class="c1"># Get the limits.</span>
        <span class="n">lower_limit</span><span class="p">,</span> <span class="n">upper_limit</span> <span class="o">=</span> <span class="n">get_action_limits</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">param_name</span><span class="p">)</span>

        <span class="c1"># Evaluate if the parameter is below/above the lower/upper limit.</span>
        <span class="c1"># if (param_value &lt; lower_limit) or (param_value &gt; upper_limit):</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">param_value</span> <span class="o">&lt;</span> <span class="n">lower_limit</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_value</span> <span class="o">&gt;</span> <span class="n">upper_limit</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">param_value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">deviation</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">deviation</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">deviation</span>

    <span class="n">df_deviation</span><span class="p">[</span><span class="n">col_name_deviation</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_classify_deviation</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">param</span><span class="p">,),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> DONE!&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_deviation</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">


<a id="kipy.classify_deviation_extra"></a>
  <div class="doc doc-contents first">
  
      <p><code>classify_deviation_extra</code></p>
<p>Calculate if an extra parameter has a deviation or not.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>These so-called extra parameters are those that are neither an 
excursion (related to IPCs) or an OOS (related to CQAs) since they
aren't defined as neither. However, they are still asked as part
of the process monitoring.</p>
</div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>product</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The product of interest. Possible values are:</p>
<ul>
<li><code>yescarta</code> or <code>clp</code></li>
<li><code>tecartus</code> or <code>xlp</code></li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df</code></td>
          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Original DataFrame.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>param</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Parameter name. Possible values are the columns defined in 
<a class="autorefs autorefs-internal" href="#kipy.get_deviation_cols_extra"><code>kipy.get_deviation_cols_extra</code></a> plus <code>vi_bags</code> and <code>vcn_bags</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Define if verbose output will be printed (<code>True</code>) or not (<code>False</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>df_deviation</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>A copy of the input DataFrame with an extra column named
<code>col_name_deviation</code> that defines if a row was a deviation (True) 
or not (False).</p></td>
        </tr>
    </tbody>
  </table>
      <h3 id="kipy.classify_deviation_extra--see-also">See also</h3>
<ul>
<li><a class="autorefs autorefs-internal" href="#kipy.get_deviation_cols_extra"><code>kipy.get_deviation_cols_extra</code></a></li>
</ul>

      <details class="quote">
        <summary>Source code in <code>kipy\deviations.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">classify_deviation_extra</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; `classify_deviation_extra`</span>

<span class="sd">    Calculate if an extra parameter has a deviation or not.</span>

<span class="sd">    !!! info</span>
<span class="sd">        These so-called extra parameters are those that are neither an </span>
<span class="sd">        excursion (related to IPCs) or an OOS (related to CQAs) since they</span>
<span class="sd">        aren&#39;t defined as neither. However, they are still asked as part</span>
<span class="sd">        of the process monitoring.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    product : str</span>
<span class="sd">        The product of interest. Possible values are:</span>

<span class="sd">        * `yescarta` or `clp`</span>
<span class="sd">        * `tecartus` or `xlp`</span>

<span class="sd">    df : pandas DataFrame</span>
<span class="sd">        Original DataFrame.</span>

<span class="sd">    param : string</span>
<span class="sd">        Parameter name. Possible values are the columns defined in </span>
<span class="sd">        [`kipy.get_deviation_cols_extra`][] plus `vi_bags` and `vcn_bags`.</span>

<span class="sd">    verbose : bool</span>
<span class="sd">        Define if verbose output will be printed (`True`) or not (`False`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_deviation : pandas DataFrame</span>
<span class="sd">        A copy of the input DataFrame with an extra column named</span>
<span class="sd">        `col_name_deviation` that defines if a row was a deviation (True) </span>
<span class="sd">        or not (False).</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    * [`kipy.get_deviation_cols_extra`][]</span>
<span class="sd">    &quot;&quot;&quot;</span>  

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Classifiying deviation for (extra) column </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Create a new copy of the DataFrame.</span>
    <span class="n">df_deviation</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">param</span> <span class="o">==</span> <span class="s1">&#39;vcn_bags&#39;</span><span class="p">:</span>

        <span class="c1"># So far, we evaluate VCN only for TECARTUS.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;yescarta&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;clp&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">vcn_bags is not being evaluated for YESCARTA&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;tecartus&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;xlp&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;vcn_bag1_oos&#39;</span> <span class="ow">in</span> <span class="n">df_deviation</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s1">&#39;vcn_bag2_oos&#39;</span> <span class="ow">in</span> <span class="n">df_deviation</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">df_deviation</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_oos&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_deviation</span><span class="p">[</span><span class="s1">&#39;vcn_bag1_oos&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">df_deviation</span><span class="p">[</span><span class="s1">&#39;vcn_bag2_oos&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot classify </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">. Either column vcn_bag1 or vcn_bag2 are missing.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s2"> is not a valid product.&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">param</span> <span class="o">==</span> <span class="s1">&#39;vi_bag1&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param</span> <span class="o">==</span> <span class="s1">&#39;vi_bag2&#39;</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">_classify_oos_vi</span><span class="p">(</span><span class="n">param_</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">param_</span> <span class="o">==</span> <span class="s1">&#39;fail&#39;</span><span class="p">:</span>
                <span class="n">oos</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">param_</span> <span class="o">==</span> <span class="s1">&#39;pass&#39;</span><span class="p">:</span>
                <span class="n">oos</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">param_</span><span class="p">):</span>
                <span class="n">oos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected parameter value in </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">oos</span>
        <span class="n">df_deviation</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_deviation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_classify_oos_vi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">param</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">param</span> <span class="o">==</span> <span class="s1">&#39;vi_bags&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;vi_bag1_deviation&#39;</span> <span class="ow">in</span> <span class="n">df_deviation</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s1">&#39;vi_bag2_deviation&#39;</span> <span class="ow">in</span> <span class="n">df_deviation</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">df_deviation</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_deviation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_deviation</span><span class="p">[</span><span class="s1">&#39;vi_bag1_deviation&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">df_deviation</span><span class="p">[</span><span class="s1">&#39;vi_bag2_deviation&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot classify </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">. Either column vi_bag1_deviation or vi_bag2_deviation are missing.&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid parameter name.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> DONE!&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_deviation</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">


<a id="kipy.get_batches_oos_list"></a>
  <div class="doc doc-contents first">
  
      <p><code>get_batches_oos_list</code></p>
<p>Obtain a DataFrame with a of batches and a list of their OOS.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>DataFrame with <code>_oos</code> columns as obtained from functions
<a class="autorefs autorefs-internal" href="#kipy.classify_deviation"><code>kipy.classify_deviation</code></a>, <a class="autorefs autorefs-internal" href="#kipy.classify_deviation_extra"><code>kipy.classify_deviation_extra</code></a>,
and <a class="autorefs autorefs-internal" href="#kipy.count_deviations"><code>kipy.count_deviations</code></a>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>verbose : bool
    Define if verbose output will be printed (True) or not (False).</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>df_oos_cases</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>DataFrame with the batches with OOS. Each row is a batch.
It has the following columns:</p>
<table>
<thead>
<tr>
<th>Parameter name</th>
<th>Output DataFrame name</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>batch_id</code></td>
<td>Batch ID</td>
</tr>
<tr>
<td><code>production_date_formatted</code></td>
<td>Production date</td>
</tr>
<tr>
<td><code>oos_description</code></td>
<td>OOS list</td>
</tr>
<tr>
<td><code>status</code></td>
<td>Status</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
</div>
<p>Do <em>not</em> change the names of the columns of the output DataFrame.
If they are changed, they will also need to be updated in
the Power BI dashboard.</p></td>
        </tr>
    </tbody>
  </table>
      <h3 id="kipy.get_batches_oos_list--see-also">See also</h3>
<ul>
<li><a class="autorefs autorefs-internal" href="#kipy.classify_deviation"><code>kipy.classify_deviation</code></a></li>
<li><a class="autorefs autorefs-internal" href="#kipy.classify_deviation_extra"><code>kipy.classify_deviation_extra</code></a></li>
<li><a class="autorefs autorefs-internal" href="#kipy.count_deviations"><code>kipy.count_deviations</code></a></li>
</ul>

      <details class="quote">
        <summary>Source code in <code>kipy\deviations.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_batches_oos_list</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`get_batches_oos_list`</span>

<span class="sd">    Obtain a DataFrame with a of batches and a list of their OOS.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas DataFrame</span>
<span class="sd">        DataFrame with `_oos` columns as obtained from functions</span>
<span class="sd">        [`kipy.classify_deviation`][], [`kipy.classify_deviation_extra`][],</span>
<span class="sd">        and [`kipy.count_deviations`][].</span>

<span class="sd">    verbose : bool</span>
<span class="sd">        Define if verbose output will be printed (True) or not (False).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_oos_cases : pandas DataFrame</span>
<span class="sd">        DataFrame with the batches with OOS. Each row is a batch.</span>
<span class="sd">        It has the following columns:</span>

<span class="sd">        | Parameter name              | Output DataFrame name |</span>
<span class="sd">        |-----------------------------|-----------------------|</span>
<span class="sd">        | `batch_id`                  | Batch ID              |</span>
<span class="sd">        | `production_date_formatted` | Production date       |</span>
<span class="sd">        | `oos_description`           | OOS list              |</span>
<span class="sd">        | `status`                    | Status                |</span>

<span class="sd">        !!! warning</span>
<span class="sd">            Do *not* change the names of the columns of the output DataFrame.</span>
<span class="sd">            If they are changed, they will also need to be updated in</span>
<span class="sd">            the Power BI dashboard.</span>


<span class="sd">    See also</span>
<span class="sd">    ----------</span>
<span class="sd">    * [`kipy.classify_deviation`][]</span>
<span class="sd">    * [`kipy.classify_deviation_extra`][]</span>
<span class="sd">    * [`kipy.count_deviations`][]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Getting list of batches with OOS...&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Get batches that have an OOS.</span>
    <span class="n">df_oos_cases</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;oos == True&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Get OOS columns.</span>
    <span class="n">cols_all</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_oos_cases</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">cols_oos</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">get_elements_with_substring</span><span class="p">(</span><span class="n">cols_all</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;_oos&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_get_oos_list</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>

        <span class="c1"># List of OOS will be appended here.</span>
        <span class="n">oos_description</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># Loop through OOS columns and format their name into </span>
        <span class="c1"># text to be appendend.</span>
        <span class="k">for</span> <span class="n">col_oos</span> <span class="ow">in</span> <span class="n">cols_oos</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="n">col_oos</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">oos_description</span> <span class="o">=</span> <span class="n">oos_description</span> <span class="o">+</span> <span class="n">col_oos</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_oos&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span>

        <span class="c1"># Remove last comma and space.</span>
        <span class="k">if</span> <span class="n">oos_description</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">oos_description</span> <span class="o">=</span> <span class="n">oos_description</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">oos_description</span>

    <span class="c1"># If there are batches with OOS, fill the DataFrame.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_oos_cases</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>

        <span class="c1"># Get the list of OOS.</span>
        <span class="n">df_oos_cases</span><span class="p">[</span><span class="s1">&#39;oos_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_oos_cases</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_get_oos_list</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Get the status.</span>
        <span class="n">df_oos_cases</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_oos_cases</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>

        <span class="c1"># Return only a select number of columns (to match the report structure).</span>
        <span class="n">df_oos_cases</span> <span class="o">=</span> <span class="n">df_oos_cases</span><span class="p">[[</span><span class="s1">&#39;batch_id&#39;</span><span class="p">,</span> <span class="s1">&#39;production_date_formatted&#39;</span><span class="p">,</span> <span class="s1">&#39;oos_description&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">]]</span>

        <span class="c1"># Rename columns (to match report structure)</span>
        <span class="n">df_oos_cases</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;batch_id&#39;</span><span class="p">:</span><span class="s1">&#39;Batch ID&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;production_date_formatted&#39;</span><span class="p">:</span><span class="s1">&#39;Production date&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;oos_description&#39;</span><span class="p">:</span><span class="s1">&#39;OOS list&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;status&#39;</span><span class="p">:</span><span class="s1">&#39;Status&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># If not, return an empty DataFrame.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df_oos_cases</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Batch ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Production date&#39;</span><span class="p">,</span> <span class="s1">&#39;OOS list&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">DONE!&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_oos_cases</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">


<a id="kipy.count_deviations"></a>
  <div class="doc doc-contents first">
  
      <p><code>count_deviations</code></p>
<p>Add columns that count the number of excursions/OOS for each batch.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>product</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The product of interest. Possible values are:</p>
<ul>
<li><code>yescarta</code> or <code>clp</code></li>
<li><code>tecartus</code> or <code>xlp</code></li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
</div>
<p>Currently, there is no distinction between YESCARTA and 
TECARTUS. However, we leave this parameter as a place holder
in case it is needed in the future.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df</code></td>
          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>Original DataFrame.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>deviation_type</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>Deviation type of interest. Possible values are:</p>
<ul>
<li><code>excursion</code> (related to IPCs)</li>
<li><code>oos</code> (related to CQAs)</li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Define if verbose output will be printed (<code>True</code>) or not (<code>False</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>df_deviations_counted</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>A copy of the input DataFrame with two extra columns. Their names
depend on the <code>deviation_type</code> of interest.</p>
<table>
<thead>
<tr>
<th><code>deviation_type</code></th>
<th>Added columns</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>excursion</code></td>
<td>* <code>excursion_total</code>: number of excursions of the given batch.</td>
</tr>
<tr>
<td></td>
<td>* <code>excursion</code>: bool that indicates if the batch had one excursion or more.</td>
</tr>
<tr>
<td><code>oos</code></td>
<td>* <code>oos_total</code>: number of OOS of the given batch.</td>
</tr>
<tr>
<td></td>
<td>* <code>oos</code>: bool that indicates if the batch had one OOS or more.</td>
</tr>
</tbody>
</table></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>kipy\deviations.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">count_deviations</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">deviation_type</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; `count_deviations`</span>

<span class="sd">    Add columns that count the number of excursions/OOS for each batch.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    product : str</span>
<span class="sd">        The product of interest. Possible values are:</span>

<span class="sd">        * `yescarta` or `clp`</span>
<span class="sd">        * `tecartus` or `xlp`</span>

<span class="sd">        !!! info</span>
<span class="sd">            Currently, there is no distinction between YESCARTA and </span>
<span class="sd">            TECARTUS. However, we leave this parameter as a place holder</span>
<span class="sd">            in case it is needed in the future.</span>

<span class="sd">    df : pandas DataFrame</span>
<span class="sd">        Original DataFrame.</span>

<span class="sd">    deviation_type : string</span>
<span class="sd">        Deviation type of interest. Possible values are:</span>

<span class="sd">        * `excursion` (related to IPCs)</span>
<span class="sd">        * `oos` (related to CQAs)</span>

<span class="sd">    verbose : bool</span>
<span class="sd">        Define if verbose output will be printed (`True`) or not (`False`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_deviations_counted : pandas DataFrame</span>
<span class="sd">        A copy of the input DataFrame with two extra columns. Their names</span>
<span class="sd">        depend on the `deviation_type` of interest.</span>

<span class="sd">        | `deviation_type` | Added columns                                                              |</span>
<span class="sd">        |------------------|----------------------------------------------------------------------------|</span>
<span class="sd">        | `excursion`      | * `excursion_total`: number of excursions of the given batch.              |</span>
<span class="sd">        |                  | * `excursion`: bool that indicates if the batch had one excursion or more. |</span>
<span class="sd">        | `oos`            | * `oos_total`: number of OOS of the given batch.                           |</span>
<span class="sd">        |                  | * `oos`: bool that indicates if the batch had one OOS or more.             |</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df_deviations_counted</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Get a list of all the deviation columns.</span>
    <span class="n">cols_all</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">deviation_cols</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">get_elements_with_substring</span><span class="p">(</span><span class="n">cols_all</span><span class="p">,</span>  <span class="p">[</span><span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">deviation_type</span><span class="p">])</span>

    <span class="c1"># We remove this `vcn_bags_oos` to avoid counting this OOS twice, </span>
    <span class="c1"># since `vcn_bags_oos` depends on vcn_bag1_oos and vcn_bag2_oos.</span>
    <span class="k">if</span> <span class="s1">&#39;vcn_bags_oos&#39;</span> <span class="ow">in</span> <span class="n">deviation_cols</span><span class="p">:</span>
        <span class="n">deviation_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;vcn_bags_oos&#39;</span><span class="p">)</span>


    <span class="n">_df_tmp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">deviation_cols</span><span class="p">]</span>

    <span class="c1"># Count the number of `deviation_type`s at hand </span>
    <span class="c1"># (e.g., sum of all OOS, sum of all excursions)</span>
    <span class="n">df_deviations_counted</span><span class="p">[</span><span class="n">deviation_type</span> <span class="o">+</span> <span class="s1">&#39;_total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_df_tmp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

    <span class="c1"># Define if `deviation_type` was present </span>
    <span class="c1"># (e.g., if there was at least one OOS, the batch is considered OOS)</span>
    <span class="n">df_deviations_counted</span><span class="p">[</span><span class="n">deviation_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">_df_tmp</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_deviations_counted</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">


<a id="kipy.get_deviation_summary"></a>
  <div class="doc doc-contents first">
  
      <p><code>get_deviation_summary</code></p>
<p>Get a summary with the number and percentage of batches with deviations
(OOS or exception) of a given DataFrame.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>DataFrame with <code>_oos</code> columns as obtained from functions
<a class="autorefs autorefs-internal" href="#kipy.classify_deviation"><code>kipy.classify_deviation</code></a>, <a class="autorefs autorefs-internal" href="#kipy.classify_deviation_extra"><code>kipy.classify_deviation_extra</code></a>,
and <a class="autorefs autorefs-internal" href="#kipy.count_deviations"><code>kipy.count_deviations</code></a>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>deviation_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Define which type of deviations will be counted. Possible values are: </p>
<ul>
<li>
<p><code>'oos'</code></p>
</li>
<li>
<p><code>'excursion'</code></p>
</li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>partitioned</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If <code>True</code>, the data will be partitioned into past and present
(thus <code>date_end</code> is a mandatory input). If <code>False</code>, the summary will 
be provided for all data.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>date_end</code></td>
          <td>
                <code>Given by </code>
          </td>
          <td><p>End date as given by <a class="autorefs autorefs-internal" href="../miscellaneous/#kipy.get_date_end"><code>kipy.get_date_end</code></a></p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>offset</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Offset for <code>date_start</code>. </p>
<p>In case <code>date_end</code> corresponds to a monthly resolution, <code>offset</code> is 
in months. </p>
<p>In case <code>date_end</code> corresponds to a quarterly resolution, <code>offset</code> is 
in quarters.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
</div>
<p>For the current Process Monitoring format, <code>offset</code> should be set to:</p>
<ul>
<li>For <code>monthly</code>, 6 (i.e., six months)</li>
<li>For <code>quarterly</code>, 2 (i.e., six months)</li>
</ul></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Define if verbose output will be printed (True) or not (False).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>df_deviation_summary</code></td>          <td>
                <code>pandas DataFrame</code>
          </td>
          <td><p>For each OOS/excursion column, the output DataFrame will have
a <code>_n</code> and a <code>_p</code> row for number and percentage, respectively.</p>
<p>In case <code>partitioned == True</code>, additionally there will be a <code>past_</code>
and a <code>present_</code> case.</p></td>
        </tr>
    </tbody>
  </table>
      <h3 id="kipy.get_deviation_summary--see-also">See also</h3>
<ul>
<li><a class="autorefs autorefs-internal" href="#kipy.classify_deviation"><code>kipy.classify_deviation</code></a></li>
<li><a class="autorefs autorefs-internal" href="#kipy.classify_deviation_extra"><code>kipy.classify_deviation_extra</code></a></li>
<li><a class="autorefs autorefs-internal" href="#kipy.count_deviations"><code>kipy.count_deviations</code></a></li>
<li><a class="autorefs autorefs-internal" href="../miscellaneous/#kipy.get_date_end"><code>kipy.get_date_end</code></a></li>
</ul>

      <details class="quote">
        <summary>Source code in <code>kipy\deviations.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_deviation_summary</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">deviation_type</span><span class="p">,</span> <span class="n">partitioned</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">date_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`get_deviation_summary`</span>

<span class="sd">    Get a summary with the number and percentage of batches with deviations</span>
<span class="sd">    (OOS or exception) of a given DataFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas DataFrame</span>
<span class="sd">        DataFrame with `_oos` columns as obtained from functions</span>
<span class="sd">        [`kipy.classify_deviation`][], [`kipy.classify_deviation_extra`][],</span>
<span class="sd">        and [`kipy.count_deviations`][].</span>

<span class="sd">    deviation_type : str</span>
<span class="sd">        Define which type of deviations will be counted. Possible values are: </span>

<span class="sd">        * `&#39;oos&#39;`</span>

<span class="sd">        * `&#39;excursion&#39;`</span>

<span class="sd">    partitioned : bool</span>
<span class="sd">        If `True`, the data will be partitioned into past and present</span>
<span class="sd">        (thus `date_end` is a mandatory input). If `False`, the summary will </span>
<span class="sd">        be provided for all data.</span>

<span class="sd">    date_end : Given by `kipy.get_date_end`</span>
<span class="sd">        End date as given by [`kipy.get_date_end`][]</span>

<span class="sd">    offset : int</span>
<span class="sd">        Offset for `date_start`. </span>

<span class="sd">        In case `date_end` corresponds to a monthly resolution, `offset` is </span>
<span class="sd">        in months. </span>

<span class="sd">        In case `date_end` corresponds to a quarterly resolution, `offset` is </span>
<span class="sd">        in quarters.</span>

<span class="sd">        !!! tip</span>
<span class="sd">            For the current Process Monitoring format, `offset` should be set to:</span>

<span class="sd">            * For `monthly`, 6 (i.e., six months)</span>
<span class="sd">            * For `quarterly`, 2 (i.e., six months)</span>

<span class="sd">    verbose : bool</span>
<span class="sd">        Define if verbose output will be printed (True) or not (False).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_deviation_summary : pandas DataFrame</span>
<span class="sd">        For each OOS/excursion column, the output DataFrame will have</span>
<span class="sd">        a `_n` and a `_p` row for number and percentage, respectively.</span>

<span class="sd">        In case `partitioned == True`, additionally there will be a `past_`</span>
<span class="sd">        and a `present_` case.</span>

<span class="sd">    See also</span>
<span class="sd">    ----------</span>
<span class="sd">    * [`kipy.classify_deviation`][]</span>
<span class="sd">    * [`kipy.classify_deviation_extra`][]</span>
<span class="sd">    * [`kipy.count_deviations`][]</span>
<span class="sd">    * [`kipy.get_date_end`][]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">partitioned</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting batches&#39; </span><span class="si">{</span><span class="n">deviation_type</span><span class="si">}</span><span class="s2"> summary (partitioned)...&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting batches&#39; </span><span class="si">{</span><span class="n">deviation_type</span><span class="si">}</span><span class="s2"> summary...&quot;</span><span class="p">)</span>

    <span class="c1"># Get the names of the relevant columns.</span>
    <span class="n">cols_all</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">cols_deviations</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">get_elements_with_substring</span><span class="p">(</span><span class="n">cols_all</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">deviation_type</span><span class="p">])</span>


    <span class="c1"># If needed, partition the data between past and present.</span>
    <span class="k">if</span> <span class="n">partitioned</span><span class="p">:</span>

        <span class="c1"># Notice that we need offset date_start here!</span>
        <span class="n">date_start</span><span class="p">,</span> <span class="n">date_partition</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">get_date_start_partition</span><span class="p">(</span><span class="n">date_end</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Beginning date: </span><span class="si">{</span><span class="n">date_start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Partition date: </span><span class="si">{</span><span class="n">date_partition</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">End date: </span><span class="si">{</span><span class="n">date_end</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Quarter</span>
        <span class="k">if</span> <span class="s1">&#39;-q&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">date_end</span><span class="p">):</span>
            <span class="n">df_past</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;(production_date_q &gt;= @date_start) and (production_date_q &lt;= @date_partition)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df_present</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;production_date_q &gt; @date_partition&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Month</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_past</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;(production_date_short_formatted &gt;= @date_start) &amp; (production_date_short_formatted &lt;= @date_partition)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df_present</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;production_date_short_formatted &gt; @date_partition&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">dfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_past</span><span class="p">,</span> <span class="n">df_present</span><span class="p">]</span>
        <span class="n">prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;past_&#39;</span><span class="p">,</span> <span class="s1">&#39;present_&#39;</span><span class="p">]</span>

    <span class="c1"># If not, just put the DataFrame in the required shape.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="p">]</span>
        <span class="n">prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>


    <span class="n">deviation_summary</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Loop through all DataFrames:</span>
    <span class="c1"># If partitioned, through past and present</span>
    <span class="c1"># If not partitioned, through the single DataFrame.</span>
    <span class="k">for</span> <span class="n">df_</span><span class="p">,</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dfs</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">):</span>

        <span class="n">n_batches</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_</span><span class="p">)</span>

        <span class="c1"># Loop through all the column deviations.</span>
        <span class="k">for</span> <span class="n">col_deviations</span> <span class="ow">in</span> <span class="n">cols_deviations</span><span class="p">:</span>

            <span class="c1"># Skip individual bags VCN.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">col_deviations</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag1_oos&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">col_deviations</span> <span class="o">==</span> <span class="s1">&#39;vcn_bag2_oos&#39;</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="n">deviation_summary</span><span class="p">[</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">col_deviations</span> <span class="o">+</span> <span class="s1">&#39;_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">df_</span><span class="p">[</span><span class="n">col_deviations</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">n_batches</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">deviation_summary</span><span class="p">[</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">col_deviations</span> <span class="o">+</span> <span class="s1">&#39;_p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">deviation_summary</span><span class="p">[</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">col_deviations</span> <span class="o">+</span> <span class="s1">&#39;_n&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">n_batches</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">deviation_summary</span><span class="p">[</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">col_deviations</span> <span class="o">+</span> <span class="s1">&#39;_p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Transform dictionary to DataFrame</span>
    <span class="n">df_deviation_summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">deviation_summary</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">deviation_type</span> <span class="o">+</span> <span class="s1">&#39;_parameter&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">DONE!&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_deviation_summary</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-11-09</span>
      
        <br>
        Created:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-11-09</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/orgs/kite-msat-ds/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.path", "navigation.sections", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  </body>
</html>